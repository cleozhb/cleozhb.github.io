---
title: Linux达人养成计划
date: 2018-12-01 15:41:22
tags: Linux
---
![图片](1.png)
将正确输出结果和错误输出结果保存在同一个文件中

<!--more-->

ls sdff &>>test3.log
等价于
ls sdff >>test3.log 2>&1

将正确输出结果和错误输出结果分开保存
cat test.log >> access.log 2>>error.log


管道：第一条命令正确执行，第二条命令才会执行，并且将第一条命令的输出作为第二条命令的输入
![图片](2.png)
![图片](3.png)
![图片](4.png)![图片](5.png)

![图片](6.png)

# Linux操作文件和目录

![图片](7.png)
![图片](8.png)

# Linux 重定向
linux中一切皆为文件，无论是普通文件还是目录，还是设备，都被抽象为文件。可以用文件名来指定一个文件，但是系统每打开一个文件，会给文件分配一个叫做文件描述符的东西，系统中有3个文件非常特殊，因为他们是一直打开的，系统就给它们分配了三个固定的文件描述符。
stdin   0
stdout 1
stderr  2
![图片](9.png)

输出重定向 redirect stdout 用 > 来表示。重定向符的特点就是每次重定向之前先将文件清空。
追加是用两个大于符号>>来表示的。
![图片](10.png)

redirect stderr 重定向标准错误输出 用 2>
![图片](11.png).

管道 将前一个操作的输出作为下一个命令的输入
![图片](12.png)

每个命令只用完成一个小任务就可以了。

如上图中，首先想剔除重复的内容，用了uniq命令，进一步又希望只看到后缀为txt的字符串，又用grep进行查询，如果又想进行排序，后面再跟一个sort就可以了。

# Linux用户和文件权限
用户在自己的主目录下是有写权限的，而在其他地方则没有
![图片](13.png)
![图片](14.png)
linux是一个多用户的操作系统，这就说明可能会有很多用户使用一台计算机，大家可能会编辑同一个文件，跟据对文件的权限不同，系统将用户分为三类。首先文件有个拥有者owner，然后一个特别的小组叫做group ，这两个类型之外的人系统中称为world

以对权限的讨论就是要看owner,group,world这三类人对这个文件有没有读，写，执行的权限。
![图片](15.png)
对文件权限的控制最终要落脚到文件模式上（file mode）
![图片](16.png)
![图片](17.png)
对一个目录有写权限意味着可以对里面的文件进行创建，删除，等操作; 
![图片](18.png)
![图片](19.png)
![图片](20.png)
![图片](21.png)
# linux进程
用ps aux 查看当前进程，可以用ps aux | less进行分页，要查看特定应用的进程号可以用管道符+grep命令来查询 比如
![图片](22.png)

# Linux 查找
1.locate 查找
![图片](23.png)
locate是从一个操作系统维护的数据库中进行查找的，所以刚刚新建的文件用这条命令是找不到的，需要手动更新数据库 sudo updatedb

1. find命令

find . -type f -exec grep -n hello '{}' ';' -print 在当前目录中找到所有包含hello的文件，并标记行号。
’;‘ 单引号引起来的分号表示-exec执行命令的结束符，在-exec和‘;’之间可以输入任何的命令了
-type后面跟的就是文件的类型
-f：文件
-d：目录
-exec表示执行后面的命令，这里是执行grep命令查找hello ，-n表示显示行号，'{}'表示find命令找到的文件名，grep在这个结果中操作
-print：表示打印出找到的hello所在的文件。
![图片](24.png)

# 将本地与服务器的目录同步
上传本地文件夹到服务器中，mydir后面的/一定要去掉，从服务器中拷贝回来也是一样的命令，只不过参数的位置换了。
![图片](25.png)
![图片](26.png)

如果本地的文件夹中添加了一些文件，此时要与服务器端的同步，要怎么做呢
还是刚才的命令，但是前后的/都不能少
例如 rsync -av mydir/ happycasts.net:mydir/
-a表示全部文件，-v表示输出一些提示
![图片](27.png)

上传本地文件夹到服务器中
rsync -r mydir happycasts.net:mydir
如果本地的文件夹中添加了一些文件，此时要与服务器端的同步
rsync -av mydir/ happycasts.net:mydir/
当本地文件夹中既有增加的文件，也有删除的文件时要怎么同步呢？
rsync -av --delete mydir/ happycasts.net:mydir/
添加--delete就会将服务器上的文件夹中的文件同步删除，
如果想要只报告本地删除了哪些文件而不再服务器端进行删除用：
rsync -av --delete mydir/ happycasts.net:mydir/ --dry-run

# shell脚本编程
![图片](28.png)
指定解析器
![图片](29.png)
语句即命令，命令即语句，放在命令行中就是命令，放在脚本当中就是语句
![图片](30.png)
![图片](31.png)
我们在写脚本的时候经常会用到$#,$0,$1这些位置参数，如果执行以下命令
hello.sh 1.txt 2.txt 从左到右用空格隔开，想在脚本中引用hello.sh这个程序名的话就用$0。后面的以此类推。$#代表一共有多少个参数

shell脚本在执行时并不是在当前的shell下执行的，而是新开了一个shell
![图片](32.png)
将当前文件夹下所有文件都加上.txt后缀，在导引号中加入命令就可以得到命令的结果，所以可以像下面这样写。
![图片](33.png)

确认是否要将服务器的文件与本地的文件夹同步可以写一个脚本

sync_dryrun()是定义一个同步函数，并执行这个函数
sync_server()是真正的执行同步
下面是确定执行的代码：
![图片](34.png)

