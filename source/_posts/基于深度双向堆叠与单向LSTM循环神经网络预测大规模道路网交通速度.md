---
title: 基于深度双向堆叠与单向LSTM循环神经网络预测大规模道路网交通速度
date: 2017-09-10 21:18:16
categories: 论文笔记 
tags: [LSTM,速度预测]
---
这篇文章来自今年8月召开的国际城市计算研讨会([International Workshop on Urban Computing](http://urbcomp.ist.psu.edu/2017/accept.html)).
## 论文题目：Deep Stacked Bidirectional and Unidirectional LSTM Recurrent Neural Network for Network-wide Traffic Speed Prediction 
作者：华盛顿大学学生
## 论文背景：<br>
&emsp;深度学习方法的潜能尚未被完全挖掘出来，尤其是在预测区域的时空尺度的应用方面。这篇文章提出了一种双向深度堆叠的LSTM和单向LSTM相结合的方法来预测大规模交通网络中的交通流速。<br>
<!--more-->
## 主要内容：
&emsp;双向LSTM(bidirectional LSTM)
用双向LSTM学习历史时间序列数据和空间特征，最后一层只需要用到之前双向堆叠的LSTM的输出值，用单向LSTM来预测未来的值。<br>
![网络结构图](http://oqadn1oza.bkt.clouddn.com/%E5%8F%8C%E5%90%91+%E5%8D%95%E5%90%91LSTM%E7%BB%93%E6%9E%84.png)
&emsp;通常情况下，喂给LSTM的数据都是按照时间顺序排列好的，LSTM只学到了前向依赖，在这个过程中可能有些有用的信息被过滤掉了，导致这部分信息没有有效的通过门结构。为了将时间序列信息完全利用起来，应该让LSTM同时学习时间序列反向依赖。交通数据具有周期性，甚至可以观察到短期周期性。学习时间序列的周期性，发现交通模式，增强模型表现。双向LSTM可以处理正向和反向依赖。
此外当预测整个交通网络中的流速时，上下游的车速也应该考虑进来。但是考虑到交通网结构复杂，可能存在环路，甚至有些地方互为上下游。
本文将bidirectional 和unidirectioanl的LSTM结合起来预测交通流速。用于测试的交通网包括西雅图的323个监测站。<br>
## 创新点：
(1)扩展了交通预测区域，从原先的单个道路或少数几个相连的道路到整个交通网络<br>
(2)采用深度神经网络结构，并分析了隐藏层数量对预测结果的影响<br>
(3)采用双向LSTM增强时间序列的特征学习<br>

RNN简介：
&emsp;RNN是一种强大的深度神经网络，它通过内部的循环记忆来处理序列数据。每个隐藏层节点有当前隐藏状态ht，这个隐藏状态通过上一节点的隐藏状态和当前节点的输入来更新。
![RNN](http://oqadn1oza.bkt.clouddn.com/RNNstruct.png)
每一步隐藏层都会产生一个yt,最终的输出yT在下一步中用来预测速度。
RNN在非线性时间序列模型中表现很好，但是在反向传播的过程中，它会有梯度消失或梯度爆炸的问题，因此不能用来处理长时间依赖的时间序列。

LSTM简介：
&emsp;为了解决上述提到的RNN的问题，有很多复杂的RNN结构被提出，比较典型的有LSTM和GRU。LSTM在长时间序列依赖的问题上处理的很好。GRU是一个简化版的LSTM结构，近期被用来做机器翻译。近年来也有大量的LSTM变体被提出，但是这些变体与原始的LSTM相比性能并没有显著的提升。标准LSTM与标准RNN之间结构上唯一不同之处在于隐藏层。只是每个隐藏层单元都有更为复杂的结构。除了隐藏层状态ht和输入xt，当更新参数时，LSTM还将当前单元输入状态，当前单元输出状态、上一单元的输出状态纳入考虑。LSTM特殊的门结构让它可以将长时间依赖的信息沿着LSTM网络传递下去。LSTM隐藏单元包括三个门，输入门，遗忘门和输出门，尤其是遗忘门是LSTM成为一个有效的可扩展的模型。
![LSTM](http://oqadn1oza.bkt.clouddn.com/%E5%8F%8C%E5%90%91LSTM%E7%BB%93%E6%9E%84.png)

## 实验：
&emsp;考虑全部的P个站点，预测T时刻的交通速度用n个历史数据。输入数据可以用下图的矩阵表示：P个站点，每个站点n个数据，总共P*n个输入数据
![输入数据](http://oqadn1oza.bkt.clouddn.com/%E8%BE%93%E5%85%A5%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png)
&emsp;用n个历史时刻数据来预测T时刻的速度，输入矩阵中的每一项代表第P个位置的t-th时刻的速度。这里将全部的323个站点过去10个单位也就是50分钟的速度纳入考虑，所以该二维矩阵[n,P]=[10,323]。由于数据包括2015年一年的，所以总共有N=60/5*24*365-10组sample。所以模型最终的输入为一个[N,n,P]的3D vector。<br>
&emsp; 实验中对比了SBU-LSTM与传统的单个位置速度模型预测效果。讨论了应该用过去多久的数据来预测T时刻，实验证明过去10个单位的数据用来预测是比较合适的。实验还测试了隐藏层的个数，证明1-layer BDLSTM+1-layer LSTM的预测效果是最好的。

