---
title: static关键字的使用
date: 2018-05-25 16:48:12
tags: c++
---

### 静态变量
```
#include <stdio.h>
 
int fun(){
    static int count = 10; //在第一次进入这个函数的时候，变量a被初始化为10！并接着自减1，以后每次进入该函数，a
    return count--; //就不会被再次初始化了，仅进行自减1的操作；在static发明前，要达到同样的功能，则只能使用全局变量：    
 
}
 
int count = 1;
 
int main(void)
{
     printf("global\t\tlocal static\n");
     for(; count <= 10; ++count)
               printf("%d\t\t%d\n", count, fun());
     return 0;
} 
```

<!--more-->

这段代码定义了两个同名的变量count，一个是全局变量，一个是静态变量，它们都存储在静态存储区域。编译后用gdb调试可以看到,在程序还没有进入fun函数之前，存储在静态数据区域的变量，在程序刚开始运行就完成初始化，也是唯一的一次初始化。static局部变量定义在函数内部，它的生存周期为整个源程序，但是作用域与局部变量相同，只能在定义该变量的局部区域内使用，退出该函数后，尽管变量仍然存在但是已经不能使用它了。把局部变量改变为静态变量后是改变了它的存储方式即改变了它的生存期。把全局变量改变为静态变量后是改变了它的作用域， 限制了它的使用范围。
总之加了static之后的变量和函数会对其他源文件隐藏，利用这个特性可以在不同文件中定义同名函数和变量，而不用担心命名冲突。
static的另一个作用是默认初始化为0,其实全局变量也具备这一属性，因为全局变量也存储在静态数据区。在静态数据区，内存中所有的字节默认值都是0x00。
![图片](1.png)
![图片](2.png)

### 静态函数
* 如果这个静态函数出现在类里，那么它是一个**静态****成员****函数**；

        静态成员函数的作用在于：**调用这个函数不会访问或者修改任何对象（非static）数据成员**。
        其实很好理解，**类的静态成员(变量和方法)属于类本身**，在类加载的时候就会分配内存，可以通过类名直接去访问；**非静态成员（变量和方法）属于类的对象，所以只有在类的对象产生（创建类的实例）时才会分配内存，然后通过类的对象（实例）去访问。**
* 如果它不是出现在类中，那么它是一个普通的**全局的静态函数**。

        这样的static函数与普通函数的区别是：用static修饰的函数，限定在本源码文件中，不能被本源码文件以外的代码文件调用。而普通的函数，默认是extern的，也就是说它可以被其它代码文件调用。
  在函数的返回类型前加上关键字static，函数就被定义成为静态函数。普通 函数的定义和声明默认情况下是extern的，但静态函数只是在声明他的文件当中可见，不能被其他文件所用。因此定义静态函数有以下好处：
  <1> 其他文件中可以定义相同名字的函数，不会发生冲突。
  <2> 静态函数不能被其他文件所用。


### 参考blog
c++中static关键字总结 [https://www.cnblogs.com/songdanzju/p/7422380.html](https://www.cnblogs.com/songdanzju/p/7422380.html)
static修饰的函数作用与意义 [https://blog.csdn.net/yesyes120/article/details/79519753](https://blog.csdn.net/yesyes120/article/details/79519753)
static有什么用途 [https://www.cnblogs.com/kira2will/p/3947111.html](https://www.cnblogs.com/kira2will/p/3947111.html)